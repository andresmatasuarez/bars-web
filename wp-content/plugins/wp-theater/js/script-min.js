(function(g){var d=g("html"),e=g("body"),b=g(window);g(document).ready(function(){if(g(".wp-theater-section").length!==0){l()}if(g(".wp-theater-bigscreen").length!==0){c()}});function l(){g(".wp-theater-section").each(function(){var r=this,p=g(this),m,q,o,n=g(".video-preview",this);if(g(".video-preview").length===0){return}if(p.hasClass("youtube")){m="youtube"}else{if(p.hasClass("vimeo")){m="vimeo"}}if(g(".wp-theater-iframe",this).length!==0){o=g(".wp-theater-bigscreen",this);q=g(".wp-theater-iframe",this)}else{if(p.is("[data-theater-id]")&&g("#"+p.attr("data-theater-id")).length!==0){o=g("#"+p.attr("data-theater-id"));q=g("#"+p.attr("data-theater-id")+" .wp-theater-iframe")}}n.children("a").click(function(s){s.preventDefault()});n.click(function(s){g(".video-preview.selected",r).removeClass("selected");g(this).addClass("selected");q.attr("src",g(this).attr("data-embed-url"));h=parseInt(g(this).attr("data-embed-height"));w=parseInt(g(this).attr("data-embed-width"));ratio=w/h;q.attr("width",w);q.attr("height",h);if(!a(o)){g("html, body").animate({scrollTop:(o.offset().top-25)+"px"},300)}})})}function c(){g(".wp-theater-bigscreen").each(function(){var t=this,p=g(this),n=g(".wp-theater-bigscreen-inner",this),r=g(".wp-theater-bigscreen-options",this),o=g("a.fullwindow-toggle",this),m=g("a.lowerlights-toggle",this),q=g(".wp-theater-iframe",this),s=false;r.show();if(o.length!==0){o.click(function(u){if(!p.hasClass("fullwindow")){j();p.addClass("fullwindow");e.addClass("fullwindow");k(q,parseInt(n.width()),parseInt(n.height())-parseInt(m.height()),r)}else{p.removeClass("fullwindow");q.attr("style","");r.attr("style","");r.show();f()}u.preventDefault()});b.resize(function(){if(p.hasClass("fullwindow")){s=setTimeout(function(){k(q,parseInt(n.width()),parseInt(n.height())-parseInt(m.height()),r)},100)}else{clearTimeout(s)}})}if(m.length!==0){m.click(function(u){if(p.hasClass("lowerlights")){p.removeClass("lowerlights");g("#wp-theater-lowerlights").fadeOut(1000,function(){g("#wp-theater-lowerlights").hide()})}else{p.addClass("lowerlights");if(g("#wp-theater-lowerlights").length==0){e.prepend('<div id="wp-theater-lowerlights">&nbsp;</div>')}g("#wp-theater-lowerlights").hide().fadeIn(1000)}u.preventDefault()})}})}function k(o,q,p,n){var q=parseInt(q),p=parseInt(p);var m=i(1.777777777,q-40,p-40);n.css("width",Math.round(m.width)+"px");o.css("width",Math.round(m.width)+"px");o.css("height",Math.round(m.height)+"px");n.css("margin-left",Math.round(m.x+20)+"px");o.css("margin-left",Math.round(m.x+20)+"px");o.css("margin-top",Math.round(m.y+30)+"px")}function i(p,o,n){var m={};if(p>=o/n){m.width=parseInt(o);m.height=parseInt(o/p);m.x=0;m.y=parseInt(n-m.height)/2}else{m.width=parseInt(n*p);m.height=parseInt(n);m.x=parseInt(o-m.width)/2;m.y=0}return m}function j(){var o=e.outerWidth(),q=e.outerHeight(),n=[self.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop];d.data("scroll-position",n);d.data("previous-overflow",d.css("overflow"));d.css("overflow","hidden");window.scrollTo(n[0],n[1]);var p=e.outerWidth()-o;var m=e.outerHeight()-q;e.css({"margin-right":p,"margin-bottom":m})}function f(){d.css("overflow",d.data("previous-overflow"));var m=d.data("scroll-position");window.scrollTo(m[0],m[1]);e.css({"margin-right":0,"margin-bottom":0})}function a(n){var q=b.scrollTop();var p=q+b.height();var m=n.offset().top;var o=m+n.height();return((o<=p)&&(m>=q))}})(jQuery);